# 期权策略决策系统 - 支撑压力分析功能

## 🎯 功能概述

为期权策略决策系统页面成功添加了全面的支撑点和压力点分析功能，帮助用户更好地识别关键价位并制定相应的期权策略。

## 🔧 新增功能详情

### 1. 支撑压力位计算函数 `calculate_support_resistance()`

采用多种方法综合分析：

#### 方法一：局部高低点识别
- 在指定窗口期内寻找局部高点和低点
- 将局部高点识别为潜在阻力位
- 将局部低点识别为潜在支撑位

#### 方法二：价格密集区域分析
- 统计价格分布，找出交易频繁的价格区间
- 将高频交易区域识别为重要的支撑/阻力位

#### 方法三：技术指标位分析
- **均线支撑/阻力**：MA5、MA10、MA20、MA60
- **布林带**：上轨（阻力）、中轨、下轨（支撑）

#### 智能去重和分组
- 按1%价格容忍度合并相近价位
- 自动识别并合并多重确认的价位
- 按距离当前价格排序输出

### 2. 增强K线图表 `create_enhanced_etf_chart()`

#### 新增视觉元素：
- **绿色实线**：标记重要支撑位（S1、S2、S3）
- **红色实线**：标记重要阻力位（R1、R2、R3）
- **位置标注**：自动标注价位和编号
- 保留原有均线、布林带等技术指标

### 3. 支撑压力分析展示模块

#### 双列布局显示：
- **左列 - 关键支撑位**：
  - 显示距离当前价格最近的5个支撑位
  - 标注价位、来源和距离百分比
  
- **右列 - 关键压力位**：
  - 显示距离当前价格最近的5个阻力位
  - 标注价位、来源和距离百分比

### 4. 基于支撑压力的期权策略建议

#### 智能策略推荐：
- **接近支撑位（3%以内）**：建议卖出虚值Put策略
- **接近压力位（3%以内）**：建议卖出虚值Call策略
- **区间交易策略**：当支撑阻力区间足够大时，推荐宽跨式卖方策略
- **风险提示**：突破关键位时的对冲建议

## 📊 使用场景

### 1. 期权行权价选择
- 参考支撑位设置Put期权行权价
- 参考阻力位设置Call期权行权价
- 在关键价位附近构建保护性策略

### 2. 风险管理
- 识别潜在的突破点位
- 设置止损和止盈目标
- 预测价格可能的运行区间

### 3. 策略优化
- 结合五维技术信号和支撑压力位
- 提高期权策略的成功概率
- 优化入场和出场时机

## 🎨 界面优化

### 标题更新
- K线主图标题更新为"含支撑压力位"
- 增加支撑压力分析专门板块

### 信息呈现
- 清晰的视觉分离：支撑用绿色，压力用红色
- 百分比距离显示，便于快速判断
- 策略建议自动生成，无需人工计算

## 🔄 与现有功能的集成

### 完美融合五维信号系统
- 支撑压力分析作为第六个维度补充
- 与趋势、动能、位置、能量、波动率形成完整分析体系
- 策略建议同时考虑技术信号和关键价位

### 保持原有功能
- 不影响现有的五维信号计算
- 保留所有技术指标分析
- 维持期权策略盈亏图功能

## 📈 实际应用示例

假设当前价格2.50，分析结果如下：

**支撑位：**
- S1: 2.45 (MA20均线) 📍 距离当前价格 -2.0%
- S2: 2.40 (布林下轨) 📍 距离当前价格 -4.0%

**压力位：**
- R1: 2.55 (局部高点) 📍 距离当前价格 +2.0%
- R2: 2.60 (布林上轨) 📍 距离当前价格 +4.0%

**策略建议：**
- 💡 接近关键支撑2.45：可考虑卖出虚值Put策略，行权价设在2.45附近
- 💡 接近关键压力2.55：可考虑卖出虚值Call策略，行权价设在2.55附近
- 🎯 区间交易策略：在2.40-2.60区间内，可构建宽跨式卖方策略

## 🚀 技术亮点

1. **多维度综合分析**：结合技术指标和价格行为
2. **智能去重算法**：避免重复和相近价位
3. **动态策略建议**：基于实时价位关系生成
4. **可视化增强**：K线图直观显示关键价位
5. **风险提示完备**：包含突破情况的应对策略

这个支撑压力分析功能大大增强了期权策略决策系统的实用性，为用户提供了更加全面和精准的交易决策支持。